function parse_stats(e,t){var n=e.build.stats,a=/([0-9]+[.]?[0-9]*)/g,i=t.match(a);if(null===i)return null;var r=i.map(parseFloat);if(r.length!=n.length)return null;for(var l={},u=0;u<n.length;u++)l[n[u]]=r[u];return l}function setup_build_input(e,t){var n=document.createElement("div");n.className="input_container";var a=document.createElement("h3");a.innerHTML="Build";var i=document.createElement("select");n.appendChild(a),n.appendChild(i);for(var r in e.build.modifiers){var l=document.createElement("option"),u=document.createTextNode(r);l.value=r,l.appendChild(u),i.appendChild(l)}return t.appendChild(n),i}function setup_stats_input(e,t){var n=document.createElement("div");n.className="input_container";var a=document.createElement("h3");a.innerHTML="Stats",n.appendChild(a);var i=document.createElement("input");return n.appendChild(i),t.appendChild(n),t}function calculate_pup_stats(e,t,n,a){for(var i={},r=0;r<e.build.stats.length;r++){var l=e.build.stats[r];i[l]=(t[l]+n[l])/e.build.modifiers[a]}return i}function get_pup_build_choices(e,t,n){return t+n in e.build.inheritance?e.build.inheritance[t+n]:n+t in e.build.inheritance?e.build.inheritance[n+t]:null}function setup_genome_input(e,t){var n=document.createElement("div");n.className="input_container";var a=document.createElement("h3");a.innerHTML="Genome",n.appendChild(a);for(var i in e.genotypes){var r=document.createElement("input");r.type="text",r.re_genes=get_genome_template(e,i);var a=document.createElement("h4");a.innerHTML=i;var l=document.createElement("div");r.output=l,n.appendChild(a),n.appendChild(r),n.appendChild(l),r.oninput=function(){""==this.value?this.className="":null===str_to_genome(this.value,this.re_genes)?this.className="invalid_input":this.className="valid_input"}}return t.appendChild(n),n}function get_genome_template(e,t){var n=e.genotypes[t],a=[];for(var i in n){var r=i,l=n[i].genotypes,u=n[i].required,c=l.join("|"),o=new RegExp("^("+c+")("+c+")$"),p=[r,o,u];a.push(p)}return a}function str_to_gene(e,t,n){var a=t,i=e[a][0],r=e[a][1],l=n.match(r);return console.log("Testing if",n,"is",i," - ",!(null===l)),null===l?null:(gene_left=l[1],gene_right=l[2],[i,gene_left,gene_right])}function verify_required(e,t){for(var n=0;n<e.length;n++){var a=e[n],i=a[2],r=a[0];if(i&&!(r in t))return!1}return!0}function str_to_genome(e,t){console.log("PARSING GENOME",e),console.log(t);for(var n={},a=/[ ]+/,i=0,r=e.split(a),l=0;l<r.length;l++){var u=r[l];if(""!==u&&u!==empty_pair){for(var c=null,o=i;o<t.length;o++){var p=str_to_gene(t,o,u);if(null!==p){c=p,i=o+1;break}}if(null===c)return console.log("FAILED TO PARSE GENOME"),null;n[c[0]]=[c[1],c[2]]}}return verify_required(t,n)?(console.log("GENOME PARSED SUCCESSFULLY"),n):(console.log("REQUIRED GENE MISSING"),null)}function setup_special_options(e,t){var n=e.special,a=document.createElement("div");a.className="input_container";var i=document.createElement("ul");a.appendChild(i);for(var r in n)if("option"==n[r].activation[0]){var l=document.createElement("li");i.appendChild(l);var u=document.createElement("input");u.type="checkbox",u.value=r,l.appendChild(u);var c=document.createTextNode(r);l.appendChild(c)}t.appendChild(a)}function get_active_effects(e,t,n,a){for(var i=[],r=[],l=[],u=n.getElementsByTagName("input"),c=0;c<u.length;c++){var o=u[c];o.checked&&i.push(o.value)}for(var p=t.getElementsByTagName("input"),c=0;c<p.length;c++){var o=p[c];o.checked&&r.push(o.value)}for(var d=a.getElementsByTagName("input"),c=0;c<d.length;c++){var o=d[c];o.checked&&l.push(o.value)}var s=e.special,m=[];for(var v in s){var h=s[v],f=h.activation[0];if("option"==f)l.indexOf(v)>-1&&m.push(v);else if("trait"==f){var g=h.activation[1];i.indexOf(g)>-1?m.push(v):r.indexOf(g)>-1&&m.push(v)}}for(var _=m.slice(),c=0;c<m.length;c++){var h=m[c];if(-1!=_.indexOf(h))for(var E=s[h].disabledwith,C=0;C<E.length;C++)if(m.indexOf(E[C])>-1){_.splice(_.indexOf(h),1);break}}return _}function setup_traitform(e,t,n){var a=document.createElement("div");a.className="input_container";var i=document.createElement("h3");i.innerHTML="Traits",a.appendChild(i);var r=document.createElement("ul");a.appendChild(r);var l=e.traits;for(var u in l){var c=l[u];if((!n||c.male)&&(n||c.female)&&0!==c.inherit){var o=document.createElement("li"),p=document.createElement("input"),i=document.createTextNode(u);p.type="checkbox",p.value=u,o.appendChild(p),o.appendChild(i),r.appendChild(o)}}return t.appendChild(a),r}function calculate_pup_traits(e,t,n,a){var i=e.traits,r={};for(var l in i){var u=i[l];!a&&!u.female||a&&!u.male?r[l]=0:t.indexOf(l)>-1&&n.indexOf(l)>-1?r[l]=1-(1-u.mutate)*(1-u.inherit)*(1-u.inherit):t.indexOf(l)>-1||n.indexOf(l)>-1?r[l]=1-(1-u.mutate)*(1-u.inherit):r[l]=u.mutate}return r}function get_input_traits(){for(var e=[],t=papa_traits_input.getElementsByTagName("input"),n=0;n<t.length;n++)t[n].checked&&e.push(t[n].value);for(var a=[],i=mama_traits_input.getElementsByTagName("input"),n=0;n<i.length;n++)i[n].checked&&a.push(i[n].value);return[e,a]}var empty_pair="nn";